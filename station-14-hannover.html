<!DOCTYPE html>
<html lang="de">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>‚è∞ Station 14: Hannover - Modalverben Pr√§teritum</title>
    <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@400;500;600;700&family=Fredoka:wght@400;500;600&display=swap" rel="stylesheet">
    <script data-goatcounter="https://aguitoo.goatcounter.com/count" async src="//gc.zgo.at/count.js"></script>
    <style>
        * { margin: 0; padding: 0; box-sizing: border-box; }
        body { font-family: 'Poppins', sans-serif; background: linear-gradient(135deg, #1E3A5F 0%, #2D5A8C 50%, #3B7EC4 100%); min-height: 100vh; color: #FFFFFF; padding: 20px; padding-bottom: 100px; }
        .container { max-width: 900px; margin: 0 auto; }
        .station-header { background: rgba(255, 255, 255, 0.15); backdrop-filter: blur(15px); border-radius: 30px; padding: 30px; margin-bottom: 30px; text-align: center; }
        .station-icon { font-size: 4em; margin-bottom: 10px; }
        .station-title { font-family: 'Fredoka', sans-serif; font-size: 2.2em; color: #FFD700; margin-bottom: 5px; }
        .station-subtitle { font-size: 1.1em; color: #E0F4FF; }
        .home-btn { position: fixed; top: 20px; left: 20px; background: rgba(255,255,255,0.2); border: none; padding: 10px 15px; border-radius: 10px; color: white; cursor: pointer; font-size: 1.2em; z-index: 1000; }
        .section { background: rgba(255, 255, 255, 0.1); border-radius: 20px; padding: 25px; margin-bottom: 25px; }
        .section h2 { font-family: 'Fredoka', sans-serif; color: #FFD700; margin-bottom: 15px; }
        .story-box { background: rgba(255, 215, 0, 0.15); border-left: 4px solid #FFD700; padding: 20px; border-radius: 0 15px 15px 0; line-height: 1.8; }
        .story-box p { margin-bottom: 12px; }
        .story-box strong { color: #FFD700; }
        .collapsible { background: rgba(255, 255, 255, 0.1); border: none; padding: 15px 20px; width: 100%; text-align: left; color: #FFD700; font-size: 1.2em; font-family: 'Fredoka', sans-serif; cursor: pointer; border-radius: 15px; display: flex; justify-content: space-between; }
        .collapsible-content { max-height: 0; overflow: hidden; transition: max-height 0.3s ease; }
        .collapsible-content.open { max-height: 5000px; }
        .collapsible-inner { padding: 20px; line-height: 1.7; }
        .collapsible-inner h3 { color: #7DD3FC; margin: 15px 0 10px 0; }
        .grammar-table { width: 100%; border-collapse: collapse; margin: 10px 0; font-size: 0.9em; }
        .grammar-table th, .grammar-table td { border: 1px solid rgba(255,255,255,0.3); padding: 8px; text-align: center; }
        .grammar-table th { background: rgba(255,215,0,0.2); color: #FFD700; }
        .grammar-note { background: rgba(125,211,252,0.2); padding: 10px 15px; border-radius: 10px; margin: 10px 0; border-left: 3px solid #7DD3FC; }
        .grammar-warning { background: rgba(230,57,70,0.2); padding: 10px 15px; border-radius: 10px; margin: 10px 0; border-left: 3px solid #E63946; }
        .vocab-grid { display: grid; grid-template-columns: repeat(auto-fit, minmax(200px, 1fr)); gap: 10px; }
        .vocab-item { background: rgba(255, 255, 255, 0.1); padding: 12px; border-radius: 10px; display: flex; align-items: center; gap: 10px; }
        .vocab-emoji { font-size: 1.5em; }
        .vocab-word { font-weight: 600; color: #FFD700; }
        .vocab-meaning { font-size: 0.85em; color: #E0F4FF; }
        .level-selection { text-align: center; }
        .level-btn { display: inline-block; padding: 20px 40px; margin: 10px; border-radius: 15px; border: 3px solid; cursor: pointer; font-family: 'Fredoka', sans-serif; font-size: 1.2em; background: rgba(255,255,255,0.1); }
        .level-rubin { border-color: #E63946; color: #E63946; }
        .level-smaragd { border-color: #06D6A0; color: #06D6A0; }
        .level-amethyst { border-color: #9D4EDD; color: #9D4EDD; }
        .quiz-area { display: none; }
        .quiz-area.active { display: block; }
        .progress-bar { background: rgba(255,255,255,0.2); height: 12px; border-radius: 6px; margin-bottom: 20px; }
        .progress-fill { height: 100%; background: linear-gradient(90deg, #06D6A0, #7DD3FC); border-radius: 6px; transition: width 0.3s; }
        .question-counter { text-align: center; margin-bottom: 15px; color: #E0F4FF; }
        .question-box { background: rgba(255,255,255,0.1); padding: 25px; border-radius: 15px; margin-bottom: 20px; }
        .question-context { color: #7DD3FC; font-size: 0.9em; margin-bottom: 10px; }
        .question-text { font-size: 1.3em; margin-bottom: 20px; }
        .options-grid { display: grid; grid-template-columns: 1fr 1fr; gap: 12px; }
        .option-btn { background: rgba(255,255,255,0.1); border: 2px solid rgba(255,255,255,0.3); padding: 15px; border-radius: 12px; color: white; cursor: pointer; font-size: 1.1em; }
        .option-btn.correct { background: rgba(6, 214, 160, 0.3); border-color: #06D6A0; }
        .option-btn.wrong { background: rgba(230, 57, 70, 0.3); border-color: #E63946; }
        .gap-input { background: rgba(255,255,255,0.1); border: 2px solid rgba(255,255,255,0.3); padding: 12px 20px; border-radius: 10px; color: white; font-size: 1.2em; width: 200px; text-align: center; }
        .gap-input.correct { border-color: #06D6A0; background: rgba(6,214,160,0.2); }
        .gap-input.wrong { border-color: #E63946; background: rgba(230,57,70,0.2); }
        .check-btn { background: #5B9BD5; border: none; padding: 12px 30px; border-radius: 10px; color: white; font-size: 1.1em; cursor: pointer; margin-top: 15px; }
        .ordering-container { margin: 15px 0; }
        .ordering-source, .ordering-target { display: flex; flex-wrap: wrap; gap: 10px; min-height: 50px; padding: 15px; border-radius: 10px; margin-bottom: 15px; }
        .ordering-source { background: rgba(255,255,255,0.1); }
        .ordering-target { background: rgba(125,211,252,0.2); border: 2px dashed rgba(125,211,252,0.5); }
        .ordering-word { background: rgba(255,215,0,0.2); border: 2px solid #FFD700; padding: 10px 18px; border-radius: 8px; cursor: pointer; }
        .ordering-word.placed { opacity: 0.4; }
        .matching-container { display: grid; grid-template-columns: 1fr 1fr; gap: 20px; }
        .matching-column h4 { text-align: center; margin-bottom: 15px; color: #7DD3FC; }
        .matching-item { background: rgba(255,255,255,0.1); border: 2px solid rgba(255,255,255,0.3); padding: 15px; border-radius: 10px; margin-bottom: 10px; cursor: pointer; text-align: center; }
        .matching-item.selected { border-color: #FFD700; background: rgba(255,215,0,0.2); }
        .matching-item.matched { border-color: #06D6A0; background: rgba(6,214,160,0.2); }
        .feedback { padding: 15px; border-radius: 10px; margin-top: 15px; display: none; }
        .feedback.show { display: block; }
        .feedback.correct { background: rgba(6,214,160,0.2); border-left: 4px solid #06D6A0; }
        .feedback.wrong { background: rgba(230,57,70,0.2); border-left: 4px solid #E63946; }
        .next-btn { background: linear-gradient(135deg, #06D6A0, #7DD3FC); border: none; padding: 15px 40px; border-radius: 12px; color: white; font-size: 1.2em; cursor: pointer; margin-top: 20px; display: none; }
        .next-btn.show { display: inline-block; }
        .results-section { text-align: center; display: none; }
        .results-section.active { display: block; }
        .results-icon { font-size: 5em; margin-bottom: 20px; }
        .results-score { font-family: 'Fredoka', sans-serif; font-size: 3em; color: #FFD700; }
        .results-gems { font-size: 1.5em; color: #7DD3FC; margin-bottom: 30px; }
        .results-btn { background: linear-gradient(135deg, #667eea, #764ba2); border: none; padding: 15px 40px; border-radius: 12px; color: white; font-size: 1.1em; cursor: pointer; margin: 10px; }
        @media (max-width: 600px) { .options-grid, .matching-container { grid-template-columns: 1fr; } .level-btn { display: block; margin: 10px auto; } }
    </style>
</head>
<body>
<button class="home-btn" onclick="goHome()">üè†</button>
<div class="container">
    <div class="station-header">
        <div class="station-icon">‚è∞</div>
        <h1 class="station-title">Station 14: Hannover</h1>
        <p class="station-subtitle">Modalverben Pr√§teritum - konnte, musste, wollte...</p>
    </div>

    <div class="section">
        <h2>üìñ Die Geschichte</h2>
        <div class="story-box">
            <p>Die Freunde erinnern sich an ihre Reise. Sie sind jetzt in Hannover.</p>
            <p><strong>Sara:</strong> <em>"Erinnerst du dich an M√ºnchen? Ich <strong>wollte</strong> unbedingt das Schloss sehen!"</em></p>
            <p><strong>Leon:</strong> <em>"Ja! Aber wir <strong>konnten</strong> nicht lange bleiben, weil wir weiter <strong>mussten</strong>."</em></p>
            <p><strong>Mia:</strong> <em>"Und in den Alpen <strong>durften</strong> wir die H√∂hle besuchen. Das war toll!"</em></p>
            <p><strong>Tim:</strong> <em>"Ich <strong>sollte</strong> eigentlich zu Hause bleiben, aber ich <strong>wollte</strong> unbedingt mitkommen."</em></p>
            <p>Sie treffen einen alten Herrn namens <strong>Herr Lehmann</strong>. Er arbeitet im Museum.</p>
            <p><strong>Herr Lehmann:</strong> <em>"Als ich jung war, <strong>konnte</strong> ich auch so viel reisen. Aber ich <strong>musste</strong> arbeiten."</em></p>
            <p><strong>Sara:</strong> <em>"<strong>Wollten</strong> Sie auch Kristalle suchen?"</em></p>
            <p><strong>Herr Lehmann:</strong> <em>"Ja! Aber ich <strong>konnte</strong> sie nie finden. Ihr habt mehr Gl√ºck! Der letzte Kristall ist hier im Museum. Fr√ºher <strong>durfte</strong> niemand ihn sehen."</em></p>
            <p>Die Freunde finden einen <strong>kupferfarbenen Kristall</strong> in einer alten Vitrine!</p>
            <p><strong>Leon:</strong> <em>"Wir <strong>konnten</strong> es schaffen! Alle Kristalle!"</em></p>
            <p><em>"Der vierzehnte Kristall!"</em> rufen alle.</p>
        </div>
    </div>

    <div class="section">
        <button class="collapsible" onclick="toggleGrammar()">üìö Grammatik: Modalverben im Pr√§teritum <span id="grammarArrow">‚ñº</span></button>
        <div class="collapsible-content" id="grammarContent">
            <div class="collapsible-inner">
                <h3>Modalverben - Pr√§teritum Formen</h3>
                <table class="grammar-table">
                    <tr><th>Infinitiv</th><th>ich/er/sie/es</th><th>du</th><th>wir/sie/Sie</th><th>ihr</th></tr>
                    <tr><td><strong>k√∂nnen</strong></td><td>konnte</td><td>konntest</td><td>konnten</td><td>konntet</td></tr>
                    <tr><td><strong>m√ºssen</strong></td><td>musste</td><td>musstest</td><td>mussten</td><td>musstet</td></tr>
                    <tr><td><strong>wollen</strong></td><td>wollte</td><td>wolltest</td><td>wollten</td><td>wolltet</td></tr>
                    <tr><td><strong>sollen</strong></td><td>sollte</td><td>solltest</td><td>sollten</td><td>solltet</td></tr>
                    <tr><td><strong>d√ºrfen</strong></td><td>durfte</td><td>durftest</td><td>durften</td><td>durftet</td></tr>
                    <tr><td><strong>m√∂gen</strong></td><td>mochte</td><td>mochtest</td><td>mochten</td><td>mochtet</td></tr>
                </table>

                <div class="grammar-warning">
                    <p><strong>Wichtig:</strong> Im Pr√§teritum haben Modalverben <strong>keinen Umlaut</strong>!</p>
                    <p>k√∂nnen ‚Üí k<strong>o</strong>nnte (nicht: k√∂nnte)</p>
                    <p>m√ºssen ‚Üí m<strong>u</strong>sste (nicht: m√ºsste)</p>
                </div>

                <h3>Satzstellung</h3>
                <div class="grammar-note">
                    <p>Modalverb (Pr√§teritum) auf Position 2, Infinitiv am Ende:</p>
                    <p>Ich <strong>konnte</strong> nicht <strong>kommen</strong>.</p>
                    <p>Er <strong>musste</strong> fr√ºh <strong>aufstehen</strong>.</p>
                    <p>Sie <strong>wollte</strong> ein Buch <strong>lesen</strong>.</p>
                </div>

                <h3>Bedeutungen</h3>
                <table class="grammar-table">
                    <tr><th>Verb</th><th>Bedeutung</th><th>Beispiel</th></tr>
                    <tr><td>konnte</td><td>F√§higkeit/M√∂glichkeit</td><td>Ich konnte schwimmen.</td></tr>
                    <tr><td>musste</td><td>Notwendigkeit</td><td>Ich musste arbeiten.</td></tr>
                    <tr><td>wollte</td><td>Wunsch/Absicht</td><td>Ich wollte reisen.</td></tr>
                    <tr><td>sollte</td><td>Empfehlung/Auftrag</td><td>Ich sollte lernen.</td></tr>
                    <tr><td>durfte</td><td>Erlaubnis</td><td>Ich durfte spielen.</td></tr>
                    <tr><td>mochte</td><td>Vorliebe</td><td>Ich mochte Pizza.</td></tr>
                </table>

                <h3>‚ö†Ô∏è Pr√§teritum vs. Konjunktiv II</h3>
                <div class="grammar-warning">
                    <p><strong>Pr√§teritum</strong> (Vergangenheit): konnte, musste, wollte</p>
                    <p><strong>Konjunktiv II</strong> (w√ºrde/h√§tte): k√∂nnte, m√ºsste, wollte</p>
                    <p>Ich <strong>konnte</strong> nicht kommen. (= Es war nicht m√∂glich.)</p>
                    <p>Ich <strong>k√∂nnte</strong> kommen. (= Es w√§re m√∂glich.)</p>
                </div>
            </div>
        </div>
    </div>

    <div class="section">
        <h2>üìù Wortschatz</h2>
        <div class="vocab-grid">
            <div class="vocab-item"><span class="vocab-emoji">üí™</span><div><div class="vocab-word">k√∂nnen</div><div class="vocab-meaning">F√§higkeit haben</div></div></div>
            <div class="vocab-item"><span class="vocab-emoji">‚ùó</span><div><div class="vocab-word">m√ºssen</div><div class="vocab-meaning">notwendig sein</div></div></div>
            <div class="vocab-item"><span class="vocab-emoji">üí≠</span><div><div class="vocab-word">wollen</div><div class="vocab-meaning">den Wunsch haben</div></div></div>
            <div class="vocab-item"><span class="vocab-emoji">üëÜ</span><div><div class="vocab-word">sollen</div><div class="vocab-meaning">empfohlen werden</div></div></div>
            <div class="vocab-item"><span class="vocab-emoji">‚úÖ</span><div><div class="vocab-word">d√ºrfen</div><div class="vocab-meaning">die Erlaubnis haben</div></div></div>
            <div class="vocab-item"><span class="vocab-emoji">‚ù§Ô∏è</span><div><div class="vocab-word">m√∂gen</div><div class="vocab-meaning">gern haben</div></div></div>
            <div class="vocab-item"><span class="vocab-emoji">üèõÔ∏è</span><div><div class="vocab-word">das Museum</div><div class="vocab-meaning">Ort f√ºr Kunst/Geschichte</div></div></div>
            <div class="vocab-item"><span class="vocab-emoji">üóÑÔ∏è</span><div><div class="vocab-word">die Vitrine</div><div class="vocab-meaning">Glasschrank</div></div></div>
        </div>
    </div>

    <div class="section level-selection" id="levelSelection">
        <h2>üéÆ W√§hle dein Level</h2>
        <button class="level-btn level-rubin" onclick="startQuiz('rubin')">üî¥ Rubin<br><small>Einfach</small></button>
        <button class="level-btn level-smaragd" onclick="startQuiz('smaragd')">üü¢ Smaragd<br><small>Mittel</small></button>
        <button class="level-btn level-amethyst" onclick="startQuiz('amethyst')">üü£ Amethyst<br><small>Schwer</small></button>
    </div>

    <div class="section quiz-area" id="quizArea">
        <div class="progress-bar"><div class="progress-fill" id="progressFill"></div></div>
        <div class="question-counter" id="questionCounter"></div>
        <div class="question-box" id="questionBox"></div>
        <div class="feedback" id="feedback"></div>
        <button class="next-btn" id="nextBtn" onclick="nextQuestion()">Weiter ‚Üí</button>
    </div>

    <div class="section results-section" id="resultsSection">
        <div class="results-icon" id="resultsIcon">üèÜ</div>
        <div class="results-score" id="resultsScore"></div>
        <div class="results-gems" id="resultsGems"></div>
        <p id="resultsMessage"></p>
        <button class="results-btn" onclick="restartQuiz()">üîÑ Nochmal</button>
        <button class="results-btn" onclick="goHome()">üè† Zur Karte</button>
    </div>
</div>

<script>
const QUESTIONS_RUBIN = [
    { type: 'mc', context: 'üìñ Text', question: 'Welche Farbe hat der vierzehnte Kristall?', options: ['Kupferfarben', 'Gold', 'Silber', 'Bronze'], correct: 0 },
    { type: 'mc', context: 'üìñ Text', question: 'Wo arbeitet Herr Lehmann?', options: ['Im Museum', 'Im Rathaus', 'Im Hotel', 'Im Bahnhof'], correct: 0 },
    { type: 'mc', context: 'üìñ Text', question: 'Was wollte Sara in M√ºnchen sehen?', options: ['Das Schloss', 'Den Dom', 'Den Zoo', 'Das Stadion'], correct: 0 },
    { type: 'mc', context: '‚úèÔ∏è k√∂nnen', question: 'k√∂nnen ‚Üí Pr√§teritum (ich)', options: ['konnte', 'k√∂nnte', 'kann', 'gekonnt'], correct: 0 },
    { type: 'mc', context: '‚úèÔ∏è k√∂nnen', question: 'k√∂nnen ‚Üí Pr√§teritum (du)', options: ['konntest', 'k√∂nntest', 'kannst', 'gekonnt'], correct: 0 },
    { type: 'mc', context: '‚úèÔ∏è k√∂nnen', question: 'k√∂nnen ‚Üí Pr√§teritum (wir)', options: ['konnten', 'k√∂nnten', 'k√∂nnen', 'gekonnt'], correct: 0 },
    { type: 'mc', context: '‚úèÔ∏è m√ºssen', question: 'm√ºssen ‚Üí Pr√§teritum (ich)', options: ['musste', 'm√ºsste', 'muss', 'gemusst'], correct: 0 },
    { type: 'mc', context: '‚úèÔ∏è m√ºssen', question: 'm√ºssen ‚Üí Pr√§teritum (er)', options: ['musste', 'm√ºsste', 'muss', 'gemusst'], correct: 0 },
    { type: 'mc', context: '‚úèÔ∏è m√ºssen', question: 'm√ºssen ‚Üí Pr√§teritum (sie Pl.)', options: ['mussten', 'm√ºssten', 'm√ºssen', 'gemusst'], correct: 0 },
    { type: 'mc', context: '‚úèÔ∏è wollen', question: 'wollen ‚Üí Pr√§teritum (ich)', options: ['wollte', 'will', 'wollten', 'gewollt'], correct: 0 },
    { type: 'mc', context: '‚úèÔ∏è wollen', question: 'wollen ‚Üí Pr√§teritum (du)', options: ['wolltest', 'willst', 'wollten', 'gewollt'], correct: 0 },
    { type: 'mc', context: '‚úèÔ∏è wollen', question: 'wollen ‚Üí Pr√§teritum (ihr)', options: ['wolltet', 'wollt', 'wollten', 'gewollt'], correct: 0 },
    { type: 'mc', context: '‚úèÔ∏è sollen', question: 'sollen ‚Üí Pr√§teritum (ich)', options: ['sollte', 'soll', 'sollten', 'gesollt'], correct: 0 },
    { type: 'mc', context: '‚úèÔ∏è sollen', question: 'sollen ‚Üí Pr√§teritum (wir)', options: ['sollten', 'sollen', 'sollte', 'gesollt'], correct: 0 },
    { type: 'mc', context: '‚úèÔ∏è d√ºrfen', question: 'd√ºrfen ‚Üí Pr√§teritum (ich)', options: ['durfte', 'd√ºrfte', 'darf', 'gedurft'], correct: 0 },
    { type: 'mc', context: '‚úèÔ∏è d√ºrfen', question: 'd√ºrfen ‚Üí Pr√§teritum (er)', options: ['durfte', 'd√ºrfte', 'darf', 'gedurft'], correct: 0 },
    { type: 'mc', context: '‚úèÔ∏è d√ºrfen', question: 'd√ºrfen ‚Üí Pr√§teritum (sie Pl.)', options: ['durften', 'd√ºrften', 'd√ºrfen', 'gedurft'], correct: 0 },
    { type: 'mc', context: '‚úèÔ∏è m√∂gen', question: 'm√∂gen ‚Üí Pr√§teritum (ich)', options: ['mochte', 'm√∂chte', 'mag', 'gemocht'], correct: 0 },
    { type: 'mc', context: '‚úèÔ∏è m√∂gen', question: 'm√∂gen ‚Üí Pr√§teritum (wir)', options: ['mochten', 'm√∂chten', 'm√∂gen', 'gemocht'], correct: 0 },
    { type: 'mc', context: '‚úèÔ∏è Satz', question: 'Ich _____ nicht kommen. (k√∂nnen, Pr√§t.)', options: ['konnte', 'k√∂nnte', 'kann', 'gekonnt'], correct: 0 },
    { type: 'mc', context: '‚úèÔ∏è Satz', question: 'Er _____ fr√ºh aufstehen. (m√ºssen, Pr√§t.)', options: ['musste', 'm√ºsste', 'muss', 'gemusst'], correct: 0 },
    { type: 'mc', context: '‚úèÔ∏è Satz', question: 'Sie _____ ein Buch lesen. (wollen, Pr√§t.)', options: ['wollte', 'will', 'wollten', 'gewollt'], correct: 0 },
    { type: 'mc', context: '‚úèÔ∏è Satz', question: 'Wir _____ dort nicht parken. (d√ºrfen, Pr√§t.)', options: ['durften', 'd√ºrften', 'd√ºrfen', 'gedurft'], correct: 0 },
    { type: 'mc', context: '‚úèÔ∏è Regel', question: 'Haben Modalverben im Pr√§teritum einen Umlaut?', options: ['Nein', 'Ja', 'Manchmal', 'Nur bei k√∂nnen'], correct: 0 },
    { type: 'mc', context: '‚úèÔ∏è Bedeutung', question: '"konnte" bedeutet...', options: ['F√§higkeit/M√∂glichkeit in der Vergangenheit', 'F√§higkeit jetzt', 'Hypothetisch', 'Zukunft'], correct: 0 },
    { type: 'mc', context: '‚úèÔ∏è Bedeutung', question: '"musste" bedeutet...', options: ['Notwendigkeit in der Vergangenheit', 'Notwendigkeit jetzt', 'Hypothetisch', 'Zukunft'], correct: 0 },
    { type: 'mc', context: '‚úèÔ∏è Bedeutung', question: '"wollte" bedeutet...', options: ['Wunsch in der Vergangenheit', 'Wunsch jetzt', 'Hypothetisch', 'Zukunft'], correct: 0 },
    { type: 'order', context: 'üîÄ Satzstellung', question: 'Ordne:', words: ['Ich', 'konnte', 'nicht', 'kommen', '.'], correct: ['Ich', 'konnte', 'nicht', 'kommen', '.'] },
    { type: 'match', context: 'üîó Pr√§teritum', question: 'Ordne zu:', pairs: [{ left: 'k√∂nnen', right: 'konnte' }, { left: 'm√ºssen', right: 'musste' }, { left: 'wollen', right: 'wollte' }, { left: 'd√ºrfen', right: 'durfte' }]},
    { type: 'match', context: 'üîó Bedeutung', question: 'Ordne zu:', pairs: [{ left: 'konnte', right: 'F√§higkeit' }, { left: 'musste', right: 'Notwendigkeit' }, { left: 'wollte', right: 'Wunsch' }, { left: 'durfte', right: 'Erlaubnis' }]}
];

const QUESTIONS_SMARAGD = [
    { type: 'gap', context: 'üìñ Text', question: 'Ich _____ unbedingt das Schloss sehen! (wollen, Pr√§t.)', answer: 'wollte', alternatives: ['Wollte'] },
    { type: 'gap', context: 'üìñ Text', question: 'Wir _____ nicht lange bleiben. (k√∂nnen, Pr√§t.)', answer: 'konnten', alternatives: ['Konnten'] },
    { type: 'gap', context: 'üìñ Text', question: 'Wir _____ die H√∂hle besuchen. (d√ºrfen, Pr√§t.)', answer: 'durften', alternatives: ['Durften'] },
    { type: 'mc', context: '‚úèÔ∏è Konjugation', question: 'Du _____ gestern nicht kommen. (k√∂nnen, Pr√§t.)', options: ['konntest', 'k√∂nntest', 'kannst', 'konnte'], correct: 0 },
    { type: 'mc', context: '‚úèÔ∏è Konjugation', question: 'Ihr _____ fr√ºher aufstehen. (m√ºssen, Pr√§t.)', options: ['musstet', 'm√ºsstet', 'm√ºsst', 'mussten'], correct: 0 },
    { type: 'mc', context: '‚úèÔ∏è Konjugation', question: 'Sie (Sg.) _____ das nicht. (wollen, Pr√§t.)', options: ['wollte', 'wollten', 'will', 'wolltest'], correct: 0 },
    { type: 'gap', context: '‚úèÔ∏è Konjugation', question: 'Wir _____ das Buch lesen. (sollen, Pr√§t.)', answer: 'sollten', alternatives: ['Sollten'] },
    { type: 'gap', context: '‚úèÔ∏è Konjugation', question: 'Er _____ Pizza. (m√∂gen, Pr√§t.)', answer: 'mochte', alternatives: ['Mochte'] },
    { type: 'mc', context: '‚úèÔ∏è Satz', question: 'Als Kind _____ ich nicht schwimmen.', options: ['konnte', 'k√∂nnte', 'kann', 'gekonnt'], correct: 0 },
    { type: 'mc', context: '‚úèÔ∏è Satz', question: 'Gestern _____ ich fr√ºh aufstehen.', options: ['musste', 'm√ºsste', 'muss', 'gemusst'], correct: 0 },
    { type: 'mc', context: '‚úèÔ∏è Satz', question: 'Letzte Woche _____ wir ins Kino gehen.', options: ['wollten', 'wollen', 'wollte', 'gewollt'], correct: 0 },
    { type: 'mc', context: '‚úèÔ∏è Satz', question: 'Fr√ºher _____ man hier nicht rauchen.', options: ['durfte', 'd√ºrfte', 'darf', 'gedurft'], correct: 0 },
    { type: 'gap', context: '‚úèÔ∏è Satz', question: 'Ich _____ ihm helfen, aber ich hatte keine Zeit. (wollen, Pr√§t.)', answer: 'wollte', alternatives: ['Wollte'] },
    { type: 'gap', context: '‚úèÔ∏è Satz', question: 'Sie _____ nicht ins Konzert gehen, weil sie arbeiten _____. (k√∂nnen, m√ºssen, Pr√§t.)', answer: 'konnte', alternatives: ['Konnte'] },
    { type: 'mc', context: '‚úèÔ∏è Unterschied', question: '"konnte" vs. "k√∂nnte" - Was ist Vergangenheit?', options: ['konnte', 'k√∂nnte', 'beide', 'keine'], correct: 0 },
    { type: 'mc', context: '‚úèÔ∏è Unterschied', question: '"musste" vs. "m√ºsste" - Was ist Konjunktiv II?', options: ['m√ºsste', 'musste', 'beide', 'keine'], correct: 0 },
    { type: 'mc', context: '‚úèÔ∏è Unterschied', question: 'Welcher Satz ist Pr√§teritum?', options: ['Ich konnte nicht kommen.', 'Ich k√∂nnte kommen.', 'Ich kann kommen.', 'Ich werde kommen k√∂nnen.'], correct: 0 },
    { type: 'mc', context: '‚úèÔ∏è Fehler', question: 'Welcher Satz ist FALSCH?', options: ['Ich k√∂nnte nicht kommen. (= Vergangenheit)', 'Ich konnte nicht kommen. (= Vergangenheit)', 'Ich k√∂nnte kommen. (= Hypothetisch)', 'Ich wollte kommen.'], correct: 0 },
    { type: 'mc', context: '‚úèÔ∏è Fehler', question: 'Welcher Satz ist RICHTIG?', options: ['Er musste gestern arbeiten.', 'Er m√ºsste gestern arbeiten.', 'Er gemusst gestern arbeiten.', 'Er musst gestern arbeiten.'], correct: 0 },
    { type: 'mc', context: '‚úèÔ∏è Negation', question: 'Ich _____ es leider nicht machen. (k√∂nnen, Pr√§t.)', options: ['konnte', 'k√∂nnte', 'kann', 'gekonnt'], correct: 0 },
    { type: 'mc', context: '‚úèÔ∏è Frage', question: '_____ du gestern nicht kommen? (k√∂nnen, Pr√§t.)', options: ['Konntest', 'K√∂nntest', 'Kannst', 'Gekonnt'], correct: 0 },
    { type: 'mc', context: '‚úèÔ∏è Frage', question: '_____ ihr das Buch lesen? (m√ºssen, Pr√§t.)', options: ['Musstet', 'M√ºsstet', 'M√ºsst', 'Gemusst'], correct: 0 },
    { type: 'mc', context: '‚úèÔ∏è Frage', question: 'Warum _____ sie nicht mitkommen? (wollen, Pr√§t.)', options: ['wollte', 'will', 'wollten', 'gewollt'], correct: 0 },
    { type: 'order', context: 'üîÄ Satzstellung', question: 'Ordne:', words: ['Er', 'musste', 'gestern', 'fr√ºh', 'aufstehen', '.'], correct: ['Er', 'musste', 'gestern', 'fr√ºh', 'aufstehen', '.'] },
    { type: 'order', context: 'üîÄ Satzstellung', question: 'Ordne:', words: ['Wir', 'konnten', 'das', 'nicht', 'verstehen', '.'], correct: ['Wir', 'konnten', 'das', 'nicht', 'verstehen', '.'] },
    { type: 'match', context: 'üîó du-Form', question: 'Ordne zu:', pairs: [{ left: 'k√∂nnen', right: 'konntest' }, { left: 'm√ºssen', right: 'musstest' }, { left: 'wollen', right: 'wolltest' }, { left: 'd√ºrfen', right: 'durftest' }]},
    { type: 'match', context: 'üîó ihr-Form', question: 'Ordne zu:', pairs: [{ left: 'k√∂nnen', right: 'konntet' }, { left: 'm√ºssen', right: 'musstet' }, { left: 'wollen', right: 'wolltet' }, { left: 'd√ºrfen', right: 'durftet' }]},
    { type: 'mc', context: '‚úèÔ∏è Komplex', question: 'Als Kind _____ ich nicht Fahrrad fahren, aber jetzt _____ ich es.', options: ['konnte / kann', 'k√∂nnte / kann', 'kann / konnte', 'k√∂nnte / k√∂nnte'], correct: 0 },
    { type: 'mc', context: '‚úèÔ∏è Komplex', question: 'Gestern _____ wir nicht ins Kino gehen, weil wir lernen _____.', options: ['konnten / mussten', 'k√∂nnten / m√ºssten', 'k√∂nnen / m√ºssen', 'konnten / m√ºssten'], correct: 0 }
];

const QUESTIONS_AMETHYST = [
    { type: 'gap', context: 'üìñ Text', question: 'Ich _____ eigentlich zu Hause bleiben, aber ich _____ unbedingt mitkommen. (sollen, wollen, Pr√§t.)', answer: 'sollte', alternatives: ['Sollte'] },
    { type: 'mc', context: '‚úèÔ∏è Nebensatz', question: 'Ich wei√ü, dass er nicht kommen _____. (k√∂nnen, Pr√§t.)', options: ['konnte', 'k√∂nnte', 'kann', 'gekonnt'], correct: 0 },
    { type: 'mc', context: '‚úèÔ∏è Nebensatz', question: 'Weil ich arbeiten _____, _____ ich nicht kommen.', options: ['musste / konnte', 'm√ºsste / k√∂nnte', 'muss / kann', 'musste / k√∂nnte'], correct: 0 },
    { type: 'mc', context: '‚úèÔ∏è Nebensatz', question: 'Obwohl er krank war, _____ er arbeiten.', options: ['musste', 'm√ºsste', 'muss', 'gemusst'], correct: 0 },
    { type: 'gap', context: '‚úèÔ∏è Nebensatz', question: 'Als ich jung war, _____ ich viel reisen. (k√∂nnen, Pr√§t.)', answer: 'konnte', alternatives: ['Konnte'] },
    { type: 'gap', context: '‚úèÔ∏è Nebensatz', question: 'Weil sie keine Zeit hatte, _____ sie nicht kommen. (k√∂nnen, Pr√§t.)', answer: 'konnte', alternatives: ['Konnte'] },
    { type: 'mc', context: '‚úèÔ∏è Indirekte Rede', question: 'Er sagte, dass er nicht kommen _____. (k√∂nnen, Pr√§t.)', options: ['konnte', 'k√∂nnte', 'kann', 'gekonnt'], correct: 0 },
    { type: 'mc', context: '‚úèÔ∏è Indirekte Rede', question: 'Sie fragte, ob ich mitkommen _____. (wollen, Pr√§t.)', options: ['wollte', 'will', 'wollten', 'gewollt'], correct: 0 },
    { type: 'mc', context: '‚úèÔ∏è Kontrast', question: 'Fr√ºher _____ ich nicht schwimmen, aber jetzt _____ ich es gut.', options: ['konnte / kann', 'k√∂nnte / kann', 'kann / konnte', 'konnte / konnte'], correct: 0 },
    { type: 'mc', context: '‚úèÔ∏è Kontrast', question: 'Letztes Jahr _____ wir nicht in den Urlaub fahren. Dieses Jahr _____ wir es.', options: ['konnten / k√∂nnen', 'k√∂nnten / k√∂nnen', 'k√∂nnen / konnten', 'konnten / konnten'], correct: 0 },
    { type: 'mc', context: '‚úèÔ∏è Kontrast', question: 'Als Student _____ ich viel arbeiten. Jetzt _____ ich mehr Freizeit.', options: ['musste / habe', 'm√ºsste / habe', 'muss / hatte', 'musste / hatte'], correct: 0 },
    { type: 'gap', context: '‚úèÔ∏è Kontrast', question: 'Als Kind _____ ich kein Gem√ºse. Jetzt _____ ich es. (m√∂gen, Pr√§t. + Pr√§s.)', answer: 'mochte', alternatives: ['Mochte'] },
    { type: 'mc', context: '‚úèÔ∏è Alle Modalverben', question: 'Er _____ kommen, _____ es aber nicht, weil er arbeiten _____.', options: ['wollte / konnte / musste', 'will / kann / muss', 'wollte / k√∂nnte / m√ºsste', 'will / konnte / musste'], correct: 0 },
    { type: 'mc', context: '‚úèÔ∏è Alle Modalverben', question: 'Wir _____ p√ºnktlich sein, aber wir _____ den Bus nicht finden.', options: ['sollten / konnten', 'sollen / k√∂nnen', 'sollten / k√∂nnten', 'sollen / konnten'], correct: 0 },
    { type: 'mc', context: '‚úèÔ∏è Fehler', question: 'Welcher Satz ist FALSCH?', options: ['Ich k√∂nnte gestern nicht kommen.', 'Ich konnte gestern nicht kommen.', 'Gestern konnte ich nicht kommen.', 'Ich konnte nicht kommen.'], correct: 0 },
    { type: 'mc', context: '‚úèÔ∏è Fehler', question: 'Welcher Satz ist FALSCH?', options: ['Er m√ºsste gestern arbeiten.', 'Er musste gestern arbeiten.', 'Gestern musste er arbeiten.', 'Er musste arbeiten.'], correct: 0 },
    { type: 'mc', context: '‚úèÔ∏è Fehler', question: 'Welcher Satz ist RICHTIG?', options: ['Wir wollten gestern ins Kino gehen.', 'Wir wollte gestern ins Kino gehen.', 'Wir wollen gestern ins Kino gehen.', 'Wir gewollt gestern ins Kino gehen.'], correct: 0 },
    { type: 'mc', context: '‚úèÔ∏è ohne Infinitiv', question: 'Ich _____ das nicht. (wollen, Pr√§t., ohne Infinitiv)', options: ['wollte', 'will', 'gewollt', 'wollten'], correct: 0 },
    { type: 'mc', context: '‚úèÔ∏è ohne Infinitiv', question: 'Er _____ nach Hause. (m√ºssen, Pr√§t., ohne Infinitiv)', options: ['musste', 'muss', 'gemusst', 'm√ºsste'], correct: 0 },
    { type: 'mc', context: '‚úèÔ∏è ohne Infinitiv', question: 'Sie _____ Pizza. (m√∂gen, Pr√§t.)', options: ['mochte', 'mag', 'm√∂chte', 'gemocht'], correct: 0 },
    { type: 'gap', context: '‚úèÔ∏è Komplex', question: 'Obwohl er nicht _____, _____ er die Pr√ºfung bestehen. (wollen, k√∂nnen, Pr√§t.)', answer: 'wollte', alternatives: ['Wollte'] },
    { type: 'gap', context: '‚úèÔ∏è Komplex', question: 'Weil sie krank war, _____ sie im Bett bleiben. (m√ºssen, Pr√§t.)', answer: 'musste', alternatives: ['Musste'] },
    { type: 'order', context: 'üîÄ Satzstellung', question: 'Ordne:', words: ['Weil', 'ich', 'arbeiten', 'musste', ',', 'konnte', 'ich', 'nicht', 'kommen', '.'], correct: ['Weil', 'ich', 'arbeiten', 'musste', ',', 'konnte', 'ich', 'nicht', 'kommen', '.'] },
    { type: 'order', context: 'üîÄ Satzstellung', question: 'Ordne:', words: ['Als', 'ich', 'jung', 'war', ',', 'konnte', 'ich', 'gut', 'tanzen', '.'], correct: ['Als', 'ich', 'jung', 'war', ',', 'konnte', 'ich', 'gut', 'tanzen', '.'] },
    { type: 'match', context: 'üîó wir-Form', question: 'Ordne zu:', pairs: [{ left: 'k√∂nnen', right: 'konnten' }, { left: 'm√ºssen', right: 'mussten' }, { left: 'wollen', right: 'wollten' }, { left: 'sollen', right: 'sollten' }]},
    { type: 'match', context: 'üîó Pr√§t. vs. Konj. II', question: 'Ordne zu:', pairs: [{ left: 'konnte (Pr√§t.)', right: 'Vergangenheit' }, { left: 'k√∂nnte (Konj.)', right: 'Hypothetisch' }, { left: 'musste (Pr√§t.)', right: 'Vergangenheit' }, { left: 'm√ºsste (Konj.)', right: 'Hypothetisch' }]},
    { type: 'mc', context: '‚úèÔ∏è Schwer', question: 'Er sagte, er _____ nicht kommen, weil er arbeiten _____. (k√∂nnen, m√ºssen, Pr√§t.)', options: ['konnte / musste', 'k√∂nnte / m√ºsste', 'kann / muss', 'konnte / m√ºsste'], correct: 0 },
    { type: 'mc', context: '‚úèÔ∏è Schwer', question: 'Wir _____ den Film sehen, aber wir _____ keine Karten bekommen. (wollen, k√∂nnen, Pr√§t.)', options: ['wollten / konnten', 'wollen / k√∂nnen', 'wollten / k√∂nnten', 'wollen / konnten'], correct: 0 },
    { type: 'mc', context: '‚úèÔ∏è Schwer', question: 'Als Kind _____ ich fr√ºh ins Bett gehen, obwohl ich nicht _____.', options: ['musste / wollte', 'muss / will', 'm√ºsste / wollte', 'musste / will'], correct: 0 }
];

let currentQuestion = 0, score = 0, selectedLevel = '', currentQuestions = [];
function shuffle(a) { const arr = [...a]; for (let i = arr.length - 1; i > 0; i--) { const j = Math.floor(Math.random() * (i + 1)); [arr[i], arr[j]] = [arr[j], arr[i]]; } return arr; }
function toggleGrammar() { document.getElementById('grammarContent').classList.toggle('open'); document.getElementById('grammarArrow').textContent = document.getElementById('grammarContent').classList.contains('open') ? '‚ñ≤' : '‚ñº'; }
function startQuiz(level) { selectedLevel = level; currentQuestion = 0; score = 0; currentQuestions = shuffle(level === 'rubin' ? QUESTIONS_RUBIN : level === 'smaragd' ? QUESTIONS_SMARAGD : QUESTIONS_AMETHYST); document.getElementById('levelSelection').style.display = 'none'; document.getElementById('quizArea').classList.add('active'); showQuestion(); }
function showQuestion() { const q = currentQuestions[currentQuestion]; const box = document.getElementById('questionBox'); document.getElementById('progressFill').style.width = (currentQuestion / currentQuestions.length) * 100 + '%'; document.getElementById('questionCounter').textContent = `Frage ${currentQuestion + 1} von ${currentQuestions.length}`; document.getElementById('feedback').className = 'feedback'; document.getElementById('feedback').style.display = 'none'; document.getElementById('nextBtn').classList.remove('show'); let html = `<div class="question-context">${q.context}</div><div class="question-text">${q.question}</div>`; if (q.type === 'mc') { html += '<div class="options-grid">'; shuffle(q.options.map((opt, idx) => ({ text: opt, originalIdx: idx }))).forEach(opt => { html += `<button class="option-btn" onclick="checkMC(${opt.originalIdx}, ${q.correct}, this)">${opt.text}</button>`; }); html += '</div>'; } else if (q.type === 'gap') { html += `<input type="text" class="gap-input" id="gapInput" placeholder="..." onkeypress="if(event.key==='Enter')checkGap()"><br><button class="check-btn" onclick="checkGap()">Pr√ºfen</button>`; } else if (q.type === 'order') { html += '<div class="ordering-container"><div class="ordering-source" id="orderSource">'; shuffle([...q.words]).forEach(word => { html += `<span class="ordering-word" onclick="moveWord(this, 'toTarget')" data-word="${word}">${word}</span>`; }); html += '</div><div class="ordering-target" id="orderTarget"></div><button class="check-btn" onclick="checkOrder()">Pr√ºfen</button></div>'; } else if (q.type === 'match') { html += '<div class="matching-container"><div class="matching-column"><h4>Links</h4>'; shuffle(q.pairs.map(p => p.left)).forEach(item => { html += `<div class="matching-item" data-type="left" data-value="${item}" onclick="selectMatch(this)">${item}</div>`; }); html += '</div><div class="matching-column"><h4>Rechts</h4>'; shuffle(q.pairs.map(p => p.right)).forEach(item => { html += `<div class="matching-item" data-type="right" data-value="${item}" onclick="selectMatch(this)">${item}</div>`; }); html += '</div></div>'; } box.innerHTML = html; }
function checkMC(selected, correct, btn) { document.querySelectorAll('.option-btn').forEach(b => b.disabled = true); if (selected === correct) { btn.classList.add('correct'); showFeedback(true, 'Richtig! üéâ'); score++; } else { btn.classList.add('wrong'); document.querySelectorAll('.option-btn').forEach(b => { const idx = parseInt(b.getAttribute('onclick').match(/checkMC\((\d+)/)[1]); if (idx === correct) b.classList.add('correct'); }); showFeedback(false, 'Leider falsch.'); } }
function checkGap() { const input = document.getElementById('gapInput'); const q = currentQuestions[currentQuestion]; const userAnswer = input.value.trim().toLowerCase(); const alternatives = q.alternatives ? q.alternatives.map(a => a.toLowerCase()) : []; if (userAnswer === q.answer.toLowerCase() || alternatives.includes(userAnswer)) { input.classList.add('correct'); showFeedback(true, 'Richtig! üéâ'); score++; } else { input.classList.add('wrong'); showFeedback(false, `Richtig: ${q.answer}`); } input.disabled = true; }
function moveWord(el, dir) { if (el.classList.contains('placed')) return; const src = document.getElementById('orderSource'), tgt = document.getElementById('orderTarget'); if (dir === 'toTarget') { const clone = el.cloneNode(true); clone.onclick = function() { moveWord(this, 'toSource'); }; tgt.appendChild(clone); el.classList.add('placed'); } else { src.querySelectorAll('.ordering-word').forEach(sw => { if (sw.dataset.word === el.dataset.word && sw.classList.contains('placed')) sw.classList.remove('placed'); }); el.remove(); } }
function checkOrder() { const words = Array.from(document.getElementById('orderTarget').querySelectorAll('.ordering-word')).map(w => w.dataset.word); if (JSON.stringify(words) === JSON.stringify(currentQuestions[currentQuestion].correct)) { showFeedback(true, 'Richtig! üéâ'); score++; } else { showFeedback(false, `Richtig: ${currentQuestions[currentQuestion].correct.join(' ')}`); } }
let selectedMatch = null, matchedPairs = 0;
function selectMatch(el) { if (el.classList.contains('matched')) return; if (!selectedMatch) { selectedMatch = { element: el, type: el.dataset.type, value: el.dataset.value }; el.classList.add('selected'); } else { if (selectedMatch.type === el.dataset.type) { selectedMatch.element.classList.remove('selected'); selectedMatch = { element: el, type: el.dataset.type, value: el.dataset.value }; el.classList.add('selected'); } else { const pair = currentQuestions[currentQuestion].pairs.find(p => (p.left === selectedMatch.value && p.right === el.dataset.value) || (p.right === selectedMatch.value && p.left === el.dataset.value)); if (pair) { el.classList.add('matched'); selectedMatch.element.classList.remove('selected'); selectedMatch.element.classList.add('matched'); matchedPairs++; if (matchedPairs === currentQuestions[currentQuestion].pairs.length) { showFeedback(true, 'Alle richtig! üéâ'); score++; matchedPairs = 0; } } else { el.classList.add('wrong'); setTimeout(() => el.classList.remove('wrong'), 500); } selectedMatch.element.classList.remove('selected'); selectedMatch = null; } } }
function showFeedback(isCorrect, msg) { const fb = document.getElementById('feedback'); fb.textContent = msg; fb.className = 'feedback show ' + (isCorrect ? 'correct' : 'wrong'); document.getElementById('nextBtn').classList.add('show'); }
function nextQuestion() { currentQuestion++; selectedMatch = null; matchedPairs = 0; if (currentQuestion >= currentQuestions.length) showResults(); else showQuestion(); }
function showResults() { document.getElementById('quizArea').classList.remove('active'); document.getElementById('resultsSection').classList.add('active'); const pct = Math.round((score / currentQuestions.length) * 100); let gems = pct >= 90 ? (selectedLevel === 'amethyst' ? 30 : selectedLevel === 'smaragd' ? 20 : 10) : pct >= 70 ? (selectedLevel === 'amethyst' ? 20 : 15) : pct >= 50 ? 8 : 2; document.getElementById('resultsIcon').textContent = pct >= 90 ? 'üèÜ' : pct >= 70 ? '‚≠ê' : pct >= 50 ? 'üí™' : 'üìö'; document.getElementById('resultsScore').textContent = `${score} / ${currentQuestions.length}`; document.getElementById('resultsGems').textContent = `+${gems} üíé`; document.getElementById('resultsMessage').textContent = pct >= 90 ? 'Ausgezeichnet! Kristall gefunden!' : pct >= 50 ? 'Gut gemacht!' : 'Nochmal versuchen!'; localStorage.setItem('station14_gems', gems); localStorage.setItem('station14_completed', pct >= 50); }
function restartQuiz() { document.getElementById('resultsSection').classList.remove('active'); document.getElementById('levelSelection').style.display = 'block'; }
function goHome() { window.location.href = 'index.html'; }
</script>
</body>
</html>
